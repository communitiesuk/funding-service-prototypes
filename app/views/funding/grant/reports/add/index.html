{% extends "layouts/grantManagement.html" %}
{% set navID = 'grantReports' %}
{% set showBackLink = true %}

{# Context-aware back link and page content #}
{% if currentSectionId or sectionName %}
    {# Adding to a specific section #}
    {% set backLinkHref = "/funding/grant/reports/" + currentReportId + "/sections" %}
    {% set pageHeading = "What is the name of this task?" %}
    {% set pageSection = '' + (sectionName or '') + '' %}
    {% set contextDescription = "Enter the name of the task you want to add to this section." %}
    {% set contextExample = "For example, if the section is '" + (sectionName or "Issues and risks") + "', the task might be 'Risk mitigations' or 'Risk status'." %}
    {% set formAction = "/funding/grant/reports/" + currentReportId + "/sections/" + currentSectionId + "/tasks" %}
    {% set cancelHref = "/funding/grant/reports/" + currentReportId + "/sections" %}
{% else %}
    {# Adding directly to report (unassigned) #}
    {% set backLinkHref = "/funding/grant/reports/" + currentReportId + "/sections" %}
    {% set pageHeading = "What is the name of this task?" %}
    {% set pageSection = '' + (reportName or 'Report') + '' %}
    {% set contextDescription = "Use tasks to group related questions together. This helps the person completing the form to focus on one topic at a time." %}
    {% set contextDescriptionTwo = "You can group tasks under headings later if you need to. " %}
    {% set contextExample = "" %}
    {% set formAction = "/funding/grant/reports/" + currentReportId + "/tasks" %}
    {% set cancelHref = "/funding/grant/reports/" + currentReportId + "/sections" %}
{% endif %}

{% set showBackApplicationsLink = false %}
{% set pageSize = "l" %}
{% set pageHiddentext = "yes" %}
{% set pageNested = "yes" %}

{% block pageTitle %}{{ macroPageTitle.pageTitle(pageHeading) }}{% endblock %}

{% block beforeContent %}
    {{ govukBackLink({
        text: "Back",
        href: backLinkHref
    }) }}
{% endblock %}

{% block content %}

<div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
        {{ macroPageHeader.pageHeader(pageNested,pageHeading,pageSection,pageHiddentext,pageSize) }}

        <p class="govuk-body">{{ contextDescription }}</p>
        {% if contextDescriptionTwo %}
            <p class="govuk-body">{{ contextDescriptionTwo }}</p>
        {% endif %}

        {% if currentSectionId and contextExample %}
            <p class="govuk-body">{{ contextExample }}</p>
        {% endif %}

        <form method="post" action="{{ formAction }}">
            {% if currentSectionId %}
                {{ govukInput({
                    label: {
                        text: "Enter the name of the task",
                        classes: "govuk-label govuk-visually-hidden"
                    },
                    classes: "govuk-!-width-two-thirds",
                    id: "taskName",
                    name: "taskName",
                    attributes: {
                        "spellcheck": "false"
                    },
                    value: data.taskName
                }) }}
            {% else %}
                {{ govukInput({
                    label: {
                        text: "Enter the name of the task",
                        classes: "govuk-label govuk-visually-hidden"
                    },
                    hint: {
                        text: contextExample
                    },
                    classes: "govuk-!-width-two-thirds",
                    id: "taskName",
                    name: "taskName",
                    attributes: {
                        "spellcheck": "false"
                    },
                    value: data.taskName
                }) }}
            {% endif %}

            <div class="govuk-button-group">
                {{ govukButton({
                    text: "Add task"
                }) }}
                <a class="govuk-link" href="{{ cancelHref }}">Cancel</a>
            </div>
        </form>
    </div>
</div>
{% endblock %}