{% extends "layouts/grantManagement.html" %}
{% set navID = 'grantReports' %}
{% set showBackLink = true %}

{# Context-aware back link and page content #}
{% if currentSectionId %}
    {# Adding to a specific section #}
    {% set backLinkHref = "/funding/grant/reports/sections?reportId=" + currentReportId %}
    {% set pageHeading = "What is the name of this task?" %}
    {% set pageSection = '' + sectionName + '' %}
    {% set contextDescription = "Enter the name of the task you want to add to this section." %}
    {% set contextExample = "For example, if the section is '" + (sectionName or "Issues and risks") + "', the task might be 'Risk mitigations' or 'Risk status'." %}
{% else %}
    {# Adding directly to report (unassigned) #}
    {% set backLinkHref = "/funding/grant/reports/" %}
    {% set pageHeading = "Add a task" %}
    {% set pageSection = '' + (reportName or 'Report') + '' %}
    {% set contextDescription = "Tasks help you group related questions together. You can organise tasks into sections later if you need to." %}
    {% set contextExample = "For example, 'Risk mitigations' or 'Risk status'." %}
{% endif %}

{% set showBackApplicationsLink = false %}
{% set pageSize = "l" %}
{% set pageHiddentext = "yes" %}
{% set pageNested = "yes" %}

{% block pageTitle %}{{ macroPageTitle.pageTitle(pageHeading) }}{% endblock %}

{% block beforeContent %}
    {{ govukBackLink({
        text: "Back",
        href: backLinkHref
    }) }}
{% endblock %}

{% block content %}

<div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
        {{ macroPageHeader.pageHeader(pageNested,pageHeading,pageSection,pageHiddentext,pageSize) }}

        <p class="govuk-body">{{ contextDescription }}</p>

        {% if currentSectionId %}
            <p class="govuk-body">{{ contextExample }}</p>
        {% endif %}

        <form method="post" action="/funding/grant/reports/add/task/another">
            {% if currentSectionId %}
                {{ govukInput({
                    label: {
                        text: "Task name",
                        classes: "govuk-label govuk-visually-hidden"
                    },
                    classes: "govuk-!-width-two-thirds",
                    id: "taskName",
                    name: "taskName",
                    attributes: {
                        "spellcheck": "false"
                    },
                    value: data.taskName
                }) }}
            {% else %}
                {{ govukInput({
                    label: {
                        text: "Task name",
                        classes: "govuk-label govuk-visually-hidden"
                    },
                    hint: {
                        text: contextExample
                    },
                    classes: "govuk-!-width-two-thirds",
                    id: "taskName",
                    name: "taskName",
                    attributes: {
                        "spellcheck": "false"
                    },
                    value: data.taskName
                }) }}
            {% endif %}

            <div class="govuk-button-group">
                {{ govukButton({
                    text: "Add task"
                }) }}
                {% if currentSectionId %}
                    <a class="govuk-link" href="/funding/grant/reports/sections?reportId={{ currentReportId }}">Cancel</a>
                {% else %}
                    <a class="govuk-link" href="/funding/grant/reports/">Cancel</a>
                {% endif %}
            </div>
        </form>
    </div>
</div>
{% endblock %}