{% extends "layouts/deliver.html" %}

{% set showBackLink = false %}
{% set showBackApplicationsLink = false %}

{% set pageSize = "l" %}
{% set pageHeading = "Grants" %}
{% set pageSection = "" %}

{% block pageTitle %}{{ macroPageTitle.pageTitle(pageHeading) }}{% endblock %}

{% block content %}

<div class="govuk-grid-row">
    <div class="govuk-grid-column-full">

        {{ macroPageHeader.pageHeader(pageNested,pageHeading,pageSection,pageHiddentext,pageSize) }}

        <form method="get" action="/funding/grant/add/">
            {{ govukButton({
                text: "Set up a grant"
            }) }}
        </form>

        {% if allGrants and allGrants.length > 0 %}
            {% set tableRows = [] %}
            {% for grant in allGrants %}
                {% set grantRow = [
                    { html: '<a class="govuk-link govuk-link--no-visited-state" href="/funding/grant/?grantName=' + grant.grantName | urlencode + '">' + grant.grantName + '</a>' },
                    { text: grant.ggisNumber or "Not provided" },
                    { text: grant.primaryContactEmail or "Not provided" }
                ] %}
                {% set tableRows = (tableRows.push(grantRow), tableRows) %}
            {% endfor %}

            {{ govukTable({
                caption: "Grants",
                captionClasses: "govuk-table__caption govuk-visually-hidden",
                head: [
                    { text: "Grant", classes: "govuk-!-width-one-third" },
                    { text: "GGIS number" },
                    { text: "Email" }
                ],
                rows: tableRows
            }) }}
        {% else %}
            <div class="govuk-inset-text">
                <p class="govuk-body">You have not set up any grants yet.</p>
                <p class="govuk-body">Use the "Set up a grant" button above to create your first grant.</p>
            </div>
        {% endif %}

    </div>
</div>

{% endblock %}